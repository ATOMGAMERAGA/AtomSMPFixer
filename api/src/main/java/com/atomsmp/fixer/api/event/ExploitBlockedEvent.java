package com.atomsmp.fixer.api.event;

import org.bukkit.entity.Player;
import org.bukkit.event.Cancellable;
import org.bukkit.event.Event;
import org.bukkit.event.HandlerList;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.annotations.Nullable;

/**
 * Bir exploit engellendiğinde tetiklenen event.
 * Diğer pluginler bu eventi dinleyerek özel işlemler yapabilir.
 *
 * @author AtomSMP
 * @since 3.0.0
 */
public class ExploitBlockedEvent extends Event implements Cancellable {

    private static final HandlerList HANDLERS = new HandlerList();

    private final String moduleName;
    private final String playerName;
    private final String playerIP;
    private final String details;
    private final Player player;
    private boolean cancelled;

    /**
     * @param moduleName Engelleyen modül adı
     * @param player     Oyuncu (online ise)
     * @param playerName Oyuncu adı
     * @param playerIP   Oyuncu IP adresi
     * @param details    Engelleme detayları
     */
    public ExploitBlockedEvent(
            @NotNull String moduleName,
            @Nullable Player player,
            @NotNull String playerName,
            @NotNull String playerIP,
            @NotNull String details
    ) {
        super(true); // async
        this.moduleName = moduleName;
        this.player = player;
        this.playerName = playerName;
        this.playerIP = playerIP;
        this.details = details;
        this.cancelled = false;
    }

    /**
     * Engelleyen modül adı.
     */
    @NotNull
    public String getModuleName() {
        return moduleName;
    }

    /**
     * Engellenen oyuncu (null olabilir — bağlantı aşamasında henüz Player yok).
     */
    @Nullable
    public Player getPlayer() {
        return player;
    }

    /**
     * Engellenen oyuncu adı.
     */
    @NotNull
    public String getPlayerName() {
        return playerName;
    }

    /**
     * Oyuncunun IP adresi.
     */
    @NotNull
    public String getPlayerIP() {
        return playerIP;
    }

    /**
     * Engelleme detay mesajı.
     */
    @NotNull
    public String getDetails() {
        return details;
    }

    @Override
    public boolean isCancelled() {
        return cancelled;
    }

    @Override
    public void setCancelled(boolean cancel) {
        this.cancelled = cancel;
    }

    @NotNull
    @Override
    public HandlerList getHandlers() {
        return HANDLERS;
    }

    @NotNull
    public static HandlerList getHandlerList() {
        return HANDLERS;
    }
}
